<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /signature_generator/
  RewriteCond %{REQUEST_URI} ^/signature_generator/service-worker.js [NC]
  RewriteRule (.*) service-worker.js [QSA,L]

  # Redirect to api.php if URL starts with /signature_generator/api/
  RewriteCond %{REQUEST_URI} !(\.png|\.jpg|\.webp|\.gif|\.jpeg|\.zip|\.css|\.svg|\.js|\.pdf|\.mo|\.po)$ [NC]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_URI} !^/signature_generator/service-worker.js [NC]
  RewriteCond %{REQUEST_URI} ^/signature_generator/api/ [NC]
  RewriteCond %{REQUEST_URI} !^/signature_generator/locale/ [NC]
  RewriteRule (.*) api.php [QSA,L]

  # Redirect to routes.php for all other URLs
  RewriteCond %{REQUEST_URI} !(\.png|\.jpg|\.webp|\.gif|\.jpeg|\.zip|\.css|\.svg|\.js|\.pdf|\.mo|\.po)$ [NC]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_URI} !^/signature_generator/assets/ [NC]
  RewriteCond %{REQUEST_URI} !^/signature_generator/api/ [NC]
  RewriteCond %{REQUEST_URI} !^/signature_generator/service-worker.js [NC]
  RewriteCond %{REQUEST_URI} !^/signature_generator/locale/ [NC]
  RewriteRule (.*) routes.php [QSA,L]
</IfModule>

<IfModule mod_deflate.c>
 AddOutputFilterByType DEFLATE text/html
 AddOutputFilterByType DEFLATE text/css
 AddOutputFilterByType DEFLATE text/javascript
 AddOutputFilterByType DEFLATE text/xml
 AddOutputFilterByType DEFLATE text/plain
 AddOutputFilterByType DEFLATE image/x-icon
 AddOutputFilterByType DEFLATE image/svg+xml
 AddOutputFilterByType DEFLATE application/rss+xml
 AddOutputFilterByType DEFLATE application/javascript
 AddOutputFilterByType DEFLATE application/x-javascript
 AddOutputFilterByType DEFLATE application/xml
 AddOutputFilterByType DEFLATE application/xhtml+xml 
 AddOutputFilterByType DEFLATE application/x-font 
 AddOutputFilterByType DEFLATE application/x-font-truetype 
 AddOutputFilterByType DEFLATE application/x-font-ttf 
 AddOutputFilterByType DEFLATE application/x-font-otf 
 AddOutputFilterByType DEFLATE application/x-font-opentype 
 AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
 AddOutputFilterByType DEFLATE font/ttf 
 AddOutputFilterByType DEFLATE font/otf 
 AddOutputFilterByType DEFLATE font/opentype
# For Older Browsers Which Can't Handle Compression
 BrowserMatch ^Mozilla/4 gzip-only-text/html 
 BrowserMatch ^Mozilla/4\.0[678] no-gzip
 BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</IfModule>

<IfModule mod_headers.c>
  Header append Vary Accept env=WEBP_image
</IfModule>

<IfModule mod_mime.c>
  AddType image/webp .webp
</IfModule>
<IfModule mod_mime.c>
	AddType image/avif .avif
	AddType image/webp .webp
	AddType application/font-woff2 .woff2
	AddType application/x-font-opentype .otf
</IfModule>
<IfModule mod_expires.c>
	ExpiresActive on
	ExpiresByType text/css                      "access plus 43200 minutes"
	ExpiresByType text/javascript               "access plus 43200 minutes"
	ExpiresByType application/javascript        "access plus 43200 minutes"
	ExpiresByType application/x-javascript      "access plus 43200 minutes"
	ExpiresByType font/eot                      "access plus 43200 minutes"
	ExpiresByType font/opentype                 "access plus 43200 minutes"
	ExpiresByType font/woff                     "access plus 43200 minutes"
	ExpiresByType application/vnd.ms-fontobject "access plus 43200 minutes"
	ExpiresByType application/font-woff         "access plus 43200 minutes"
	ExpiresByType application/font-woff2        "access plus 43200 minutes"
	ExpiresByType application/x-font-ttf        "access plus 43200 minutes"
	ExpiresByType application/x-font-woff       "access plus 43200 minutes"
	ExpiresByType image/vnd.microsoft.icon      "access plus 43200 minutes"
	ExpiresByType image/x-icon                  "access plus 43200 minutes"
	ExpiresByType image/bmp                     "access plus 43200 minutes"
	ExpiresByType image/gif                     "access plus 43200 minutes"
	ExpiresByType image/jpeg                    "access plus 43200 minutes"
	ExpiresByType image/png                     "access plus 43200 minutes"
	ExpiresByType image/svg+xml                 "access plus 43200 minutes"
	ExpiresByType image/avif                    "access plus 43200 minutes"
	ExpiresByType image/webp                    "access plus 43200 minutes"
	ExpiresByType audio/ogg                     "access plus 43200 minutes"
	ExpiresByType video/mp4                     "access plus 43200 minutes"
	ExpiresByType video/ogg                     "access plus 43200 minutes"
	ExpiresByType video/webm                    "access plus 43200 minutes"
</IfModule>
<IfModule mod_headers.c>
	Header unset ETag
</IfModule>
FileETag None
<IfModule mod_headers.c>
	<FilesMatch \.(jpe|jpg|jpeg|png|gif|bmp)\.webp$>
		Header merge Vary Accept
	</FilesMatch>
</IfModule>
<IfModule mod_deflate.c>
	<IfModule mod_filter.c>
		AddOutputFilterByType DEFLATE text/plain text/css text/javascript application/javascript application/x-javascript application/json text/html text/xml application/atom+xml application/rss+xml application/xhtml+xml application/xml text/x-component application/vnd.ms-fontobject application/x-font-ttf font/eot font/opentype image/bmp image/svg+xml image/vnd.microsoft.icon image/x-icon
	</IfModule>
</IfModule>
<IfModule mod_headers.c>
	<IfModule mod_rewrite.c>
		RewriteEngine On
		RewriteCond %{HTTP:Accept-Encoding} (^|\W)gzip(\W|$)
		RewriteCond %{REQUEST_FILENAME} \.(css|js)$
		RewriteCond %{REQUEST_FILENAME}.gz -f
		RewriteRule ^(.*)\.(css|js)$ $1\.$2\.gz [QSA]
		RewriteRule \.css\.gz$ - [T=text/css,E=no-gzip:1,E=no-brotli:1]
		RewriteRule \.js\.gz$ - [T=application/javascript,E=no-gzip:1,E=no-brotli:1]
	</IfModule>
	<FilesMatch \.(js|css)\.gz$>
		Header set Content-Encoding gzip
		Header merge Vary Accept-Encoding
	</FilesMatch>
</IfModule>